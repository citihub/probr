[
    {
        "uri": "probr_output\\tmp\\service_packs\\kubernetes\\pod_security_policy\\pod_security_policy.feature",
        "id": "maximise-security-through-pod-security-policies",
        "keyword": "Feature",
        "name": "Maximise security through Pod Security Policies",
        "description": "As a Cloud Security Administrator\nI want to ensure that a stringent set of Pod Security Policies are present\nSo that a policy of least privilege can be enforced in order to prevent malicious attacks on my organization",
        "line": 3,
        "comments": [
            {
                "value": "#Rule: Insert tags here. ... for some reason 'Rule:' doesn't work in latest godog ..",
                "line": 9
            },
            {
                "value": "#TODO: for 5.2.1 .. these are all 'creation', so 'deployment running' should be changed to 'deployment created'",
                "line": 10
            },
            {
                "value": "#TODO: question .. how specific should we be on the control terminology?  e.g. should we stick with",
                "line": 11
            },
            {
                "value": "# the below, or specific, like \"And 'isPrivileged' is set to \u003ctrue|false\u003e\"??",
                "line": 12
            },
            {
                "value": "#TODO: also ... for 5.2.5, we can test to prevent creation, but what about trying to execute a cmd which reqs root?",
                "line": 13
            },
            {
                "value": "# think we should do that, but is that a separate scenario or blend into this one?  for some this makes sense - mark with @detective?",
                "line": 14
            }
        ],
        "tags": [
            {
                "name": "@k-psp",
                "line": 1
            },
            {
                "name": "@probes/kubernetes/pod_security_policy",
                "line": 2
            }
        ],
        "elements": [
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-privileged-access;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with privileged access",
                "description": "",
                "line": 28,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-001",
                        "line": 16
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 28,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment running with privileged access in an existing Kubernetes cluster",
                        "line": 28,
                        "match": {
                            "location": "pod_security_policy.go:317"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 98512200
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 28,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged access request is marked \"True\" for the Kubernetes deployment",
                        "line": 28,
                        "match": {
                            "location": "pod_security_policy.go:291"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 125904900
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with privileged access can't run\"",
                        "line": 28,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 28,
                        "match": {
                            "location": "pod_security_policy.go:335"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 28,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-privileged-access;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with privileged access",
                "description": "",
                "line": 29,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-001",
                        "line": 16
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 29,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment running with privileged access in an existing Kubernetes cluster",
                        "line": 29,
                        "match": {
                            "location": "pod_security_policy.go:317"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 29,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged access request is marked \"False\" for the Kubernetes deployment",
                        "line": 29,
                        "match": {
                            "location": "pod_security_policy.go:291"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1598255700
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 29,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 29,
                        "match": {
                            "location": "pod_security_policy.go:335"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 400437800
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 29,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 336629800
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-privileged-access;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with privileged access",
                "description": "",
                "line": 30,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-001",
                        "line": 16
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 30,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment running with privileged access in an existing Kubernetes cluster",
                        "line": 30,
                        "match": {
                            "location": "pod_security_policy.go:317"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 30,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged access request is marked \"Not Defined\" for the Kubernetes deployment",
                        "line": 30,
                        "match": {
                            "location": "pod_security_policy.go:291"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2263566200
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 30,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 30,
                        "match": {
                            "location": "pod_security_policy.go:335"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 422291800
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 30,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 318713600
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostpid;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostPID",
                "description": "",
                "line": 44,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-002",
                        "line": 32
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 44,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostPID in an existing Kubernetes cluster",
                        "line": 44,
                        "match": {
                            "location": "pod_security_policy.go:380"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 44,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostPID request is marked \"True\" for the Kubernetes deployment",
                        "line": 44,
                        "match": {
                            "location": "pod_security_policy.go:355"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 111960600
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cant run using hostPID\"",
                        "line": 44,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host PID namespace",
                        "line": 44,
                        "match": {
                            "location": "pod_security_policy.go:397"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 44,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostpid;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostPID",
                "description": "",
                "line": 45,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-002",
                        "line": 32
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 45,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostPID in an existing Kubernetes cluster",
                        "line": 45,
                        "match": {
                            "location": "pod_security_policy.go:380"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 45,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostPID request is marked \"False\" for the Kubernetes deployment",
                        "line": 45,
                        "match": {
                            "location": "pod_security_policy.go:355"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2282065400
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 45,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host PID namespace",
                        "line": 45,
                        "match": {
                            "location": "pod_security_policy.go:397"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 425599700
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 45,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 327339800
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostpid;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostPID",
                "description": "",
                "line": 46,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-002",
                        "line": 32
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 46,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostPID in an existing Kubernetes cluster",
                        "line": 46,
                        "match": {
                            "location": "pod_security_policy.go:380"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 46,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostPID request is marked \"Not Defined\" for the Kubernetes deployment",
                        "line": 46,
                        "match": {
                            "location": "pod_security_policy.go:355"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2265336400
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 46,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host PID namespace",
                        "line": 46,
                        "match": {
                            "location": "pod_security_policy.go:397"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 447059500
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 46,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 389272600
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostipc-flag.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostIPC flag.",
                "description": "",
                "line": 60,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-003",
                        "line": 48
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 60,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostIPC in an existing Kubernetes cluster",
                        "line": 60,
                        "match": {
                            "location": "pod_security_policy.go:442"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 60,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostIPC request is marked \"True\" for the Kubernetes deployment",
                        "line": 60,
                        "match": {
                            "location": "pod_security_policy.go:416"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 122019900
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with hostIPC access can't run\"",
                        "line": 60,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1102900
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host IPC namespace",
                        "line": 60,
                        "match": {
                            "location": "pod_security_policy.go:459"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 60,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostipc-flag.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostIPC flag.",
                "description": "",
                "line": 61,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-003",
                        "line": 48
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 61,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostIPC in an existing Kubernetes cluster",
                        "line": 61,
                        "match": {
                            "location": "pod_security_policy.go:442"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 416500
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 61,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostIPC request is marked \"False\" for the Kubernetes deployment",
                        "line": 61,
                        "match": {
                            "location": "pod_security_policy.go:416"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2060644600
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 61,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host IPC namespace",
                        "line": 61,
                        "match": {
                            "location": "pod_security_policy.go:459"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 342850800
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 61,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 334005400
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostipc-flag.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostIPC flag.",
                "description": "",
                "line": 62,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-003",
                        "line": 48
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 62,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostIPC in an existing Kubernetes cluster",
                        "line": 62,
                        "match": {
                            "location": "pod_security_policy.go:442"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 62,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostIPC request is marked \"Not defined\" for the Kubernetes deployment",
                        "line": 62,
                        "match": {
                            "location": "pod_security_policy.go:416"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1313083900
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 62,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host IPC namespace",
                        "line": 62,
                        "match": {
                            "location": "pod_security_policy.go:459"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 466759300
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 62,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 384031100
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostnetwork-flag.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostNetwork flag.",
                "description": "",
                "line": 76,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-004",
                        "line": 64
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 76,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostNetwork in an existing Kubernetes cluster",
                        "line": 76,
                        "match": {
                            "location": "pod_security_policy.go:504"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 76,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostNetwork request is marked \"True\" for the Kubernetes deployment",
                        "line": 76,
                        "match": {
                            "location": "pod_security_policy.go:478"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 121947300
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with hostNetwork access can't run\"",
                        "line": 76,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host network namespace",
                        "line": 76,
                        "match": {
                            "location": "pod_security_policy.go:521"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 76,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostnetwork-flag.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostNetwork flag.",
                "description": "",
                "line": 77,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-004",
                        "line": 64
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 77,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostNetwork in an existing Kubernetes cluster",
                        "line": 77,
                        "match": {
                            "location": "pod_security_policy.go:504"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 77,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostNetwork request is marked \"False\" for the Kubernetes deployment",
                        "line": 77,
                        "match": {
                            "location": "pod_security_policy.go:478"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2021778300
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 77,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host network namespace",
                        "line": 77,
                        "match": {
                            "location": "pod_security_policy.go:521"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 422041100
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 77,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 355702100
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostnetwork-flag.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostNetwork flag.",
                "description": "",
                "line": 78,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-004",
                        "line": 64
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 78,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostNetwork in an existing Kubernetes cluster",
                        "line": 78,
                        "match": {
                            "location": "pod_security_policy.go:504"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 78,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostNetwork request is marked \"Not defined\" for the Kubernetes deployment",
                        "line": 78,
                        "match": {
                            "location": "pod_security_policy.go:478"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2231230400
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 78,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host network namespace",
                        "line": 78,
                        "match": {
                            "location": "pod_security_policy.go:521"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 451006800
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 78,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 339474600
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-allowprivilegeescalation-flag;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the allowPrivilegeEscalation flag",
                "description": "",
                "line": 92,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-005",
                        "line": 80
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 92,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the allowPrivilegeEscalation in an existing Kubernetes cluster",
                        "line": 92,
                        "match": {
                            "location": "pod_security_policy.go:570"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 92,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged escalation is marked \"True\" for the Kubernetes deployment",
                        "line": 92,
                        "match": {
                            "location": "pod_security_policy.go:540"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 114031500
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cant run using the allowPrivilegeEscalation flag\"",
                        "line": 92,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a sudo command that requires privileged access",
                        "line": 92,
                        "match": {
                            "location": "pod_security_policy.go:588"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 92,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-allowprivilegeescalation-flag;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the allowPrivilegeEscalation flag",
                "description": "",
                "line": 93,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-005",
                        "line": 80
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 93,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the allowPrivilegeEscalation in an existing Kubernetes cluster",
                        "line": 93,
                        "match": {
                            "location": "pod_security_policy.go:570"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 93,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged escalation is marked \"False\" for the Kubernetes deployment",
                        "line": 93,
                        "match": {
                            "location": "pod_security_policy.go:540"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 4103925200
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 93,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a sudo command that requires privileged access",
                        "line": 93,
                        "match": {
                            "location": "pod_security_policy.go:588"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 529751900
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 93,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 372053700
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-allowprivilegeescalation-flag;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the allowPrivilegeEscalation flag",
                "description": "",
                "line": 94,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-005",
                        "line": 80
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 94,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the allowPrivilegeEscalation in an existing Kubernetes cluster",
                        "line": 94,
                        "match": {
                            "location": "pod_security_policy.go:570"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1143200
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 94,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged escalation is marked \"Not Defined\" for the Kubernetes deployment",
                        "line": 94,
                        "match": {
                            "location": "pod_security_policy.go:540"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 3126507500
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 94,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a sudo command that requires privileged access",
                        "line": 94,
                        "match": {
                            "location": "pod_security_policy.go:588"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 436303900
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 94,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 448528200
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-as-the-root-user;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running as the root user",
                "description": "",
                "line": 108,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-006",
                        "line": 96
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 108,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running as the root user in an existing Kubernetes cluster",
                        "line": 108,
                        "match": {
                            "location": "pod_security_policy.go:633"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 108,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the user requested is \"Root\" for the Kubernetes deployment",
                        "line": 108,
                        "match": {
                            "location": "pod_security_policy.go:607"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 153316100
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cant run as root\"",
                        "line": 108,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the Kubernetes deployment should run with a non-root UID",
                        "line": 108,
                        "match": {
                            "location": "pod_security_policy.go:651"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 108,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-as-the-root-user;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running as the root user",
                "description": "",
                "line": 109,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-006",
                        "line": 96
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 109,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running as the root user in an existing Kubernetes cluster",
                        "line": 109,
                        "match": {
                            "location": "pod_security_policy.go:633"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 109,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the user requested is \"Non-Root\" for the Kubernetes deployment",
                        "line": 109,
                        "match": {
                            "location": "pod_security_policy.go:607"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 8125830200
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 109,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the Kubernetes deployment should run with a non-root UID",
                        "line": 109,
                        "match": {
                            "location": "pod_security_policy.go:651"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 470006200
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 109,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 351225400
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-as-the-root-user;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running as the root user",
                "description": "",
                "line": 110,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-006",
                        "line": 96
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 110,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running as the root user in an existing Kubernetes cluster",
                        "line": 110,
                        "match": {
                            "location": "pod_security_policy.go:633"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 110,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the user requested is \"Not Defined\" for the Kubernetes deployment",
                        "line": 110,
                        "match": {
                            "location": "pod_security_policy.go:607"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2313271100
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 110,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the Kubernetes deployment should run with a non-root UID",
                        "line": 110,
                        "match": {
                            "location": "pod_security_policy.go:651"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 435144100
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 110,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 369690800
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-the-net_raw-capability.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with the NET_RAW capability.",
                "description": "    Assuming cluster is configured to prevent NET_RAW capabilities:\n    - If a container explicitly adds NET_RAW it should fail to deploy\n    - If a container explicitly drops NET_RAW it should succeed to deploy\n    - If a container doesn't add neither drop NET_RAW it should fail to deploy, since cluster will require explicit drop",
                "line": 126,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-007",
                        "line": 112
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 126,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment with NET_RAW capability \"Added\" is applied to an existing Kubernetes cluster",
                        "line": 126,
                        "match": {
                            "location": "pod_security_policy.go:669"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2387200900
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cant run with NET_RAW capabilities\"",
                        "line": 126,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod psp-test-pod-250221-123321-93 was created - test failed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-the-net_raw-capability.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with the NET_RAW capability.",
                "description": "    Assuming cluster is configured to prevent NET_RAW capabilities:\n    - If a container explicitly adds NET_RAW it should fail to deploy\n    - If a container explicitly drops NET_RAW it should succeed to deploy\n    - If a container doesn't add neither drop NET_RAW it should fail to deploy, since cluster will require explicit drop",
                "line": 127,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-007",
                        "line": 112
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 127,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment with NET_RAW capability \"Dropped\" is applied to an existing Kubernetes cluster",
                        "line": 127,
                        "match": {
                            "location": "pod_security_policy.go:669"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2011100800
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 127,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-the-net_raw-capability.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with the NET_RAW capability.",
                "description": "    Assuming cluster is configured to prevent NET_RAW capabilities:\n    - If a container explicitly adds NET_RAW it should fail to deploy\n    - If a container explicitly drops NET_RAW it should succeed to deploy\n    - If a container doesn't add neither drop NET_RAW it should fail to deploy, since cluster will require explicit drop",
                "line": 128,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-007",
                        "line": 112
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 128,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment with NET_RAW capability \"Not Defined\" is applied to an existing Kubernetes cluster",
                        "line": 128,
                        "match": {
                            "location": "pod_security_policy.go:669"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1992330200
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cant run with NET_RAW capabilities\"",
                        "line": 128,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod psp-test-pod-250221-123325-34 was created - test failed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-container-running-with-capabilities-beyond-the-default-set.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent container running with capabilities beyond the default set.",
                "description": "",
                "line": 142,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-008",
                        "line": 130
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 142,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with capabilities beyond the default set from being deployed to an existing kubernetes cluster",
                        "line": 142,
                        "match": {
                            "location": "pod_security_policy.go:788"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 142,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "additional capabilities requested for the Kubernetes deployment are \"NOT\" allowed",
                        "line": 142,
                        "match": {
                            "location": "pod_security_policy.go:720"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 9241248700
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "all operations will \"Fail\" with an error \"Containers can't run with added capabilities\"",
                        "line": 142,
                        "match": {
                            "location": "pod_security_policy.go:84"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1047300
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires capabilities outside of the default set",
                        "line": 142,
                        "match": {
                            "location": "pod_security_policy.go:805"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 142,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-container-running-with-capabilities-beyond-the-default-set.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent container running with capabilities beyond the default set.",
                "description": "",
                "line": 143,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-008",
                        "line": 130
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 143,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with capabilities beyond the default set from being deployed to an existing kubernetes cluster",
                        "line": 143,
                        "match": {
                            "location": "pod_security_policy.go:788"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 143,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "additional capabilities requested for the Kubernetes deployment are \"ARE\" allowed",
                        "line": 143,
                        "match": {
                            "location": "pod_security_policy.go:720"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1879504200
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "all operations will \"Succeed\" with an error \"\"",
                        "line": 143,
                        "match": {
                            "location": "pod_security_policy.go:84"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires capabilities outside of the default set",
                        "line": 143,
                        "match": {
                            "location": "pod_security_policy.go:805"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 10227146400
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 143,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 351352000
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-container-running-with-capabilities-beyond-the-default-set.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent container running with capabilities beyond the default set.",
                "description": "",
                "line": 144,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-008",
                        "line": 130
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 144,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with capabilities beyond the default set from being deployed to an existing kubernetes cluster",
                        "line": 144,
                        "match": {
                            "location": "pod_security_policy.go:788"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 144,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "additional capabilities requested for the Kubernetes deployment are \"Not Defined\" allowed",
                        "line": 144,
                        "match": {
                            "location": "pod_security_policy.go:720"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1553344500
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "all operations will \"Succeed\" with an error \"\"",
                        "line": 144,
                        "match": {
                            "location": "pod_security_policy.go:84"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires capabilities outside of the default set",
                        "line": 144,
                        "match": {
                            "location": "pod_security_policy.go:805"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 10206083100
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 144,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 337843000
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-assigned-capabilities.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with assigned capabilities.",
                "description": "",
                "line": 158,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-009",
                        "line": 146
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 158,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with assigned capabilities from being deployed to an existing Kubernetes cluster",
                        "line": 158,
                        "match": {
                            "location": "pod_security_policy.go:856"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 158,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "assigned capabilities \"ARE\" requested for the Kubernetes deployment",
                        "line": 158,
                        "match": {
                            "location": "pod_security_policy.go:825"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 129793700
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with assigned capabilities can't be deployed\"",
                        "line": 158,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires any capabilities",
                        "line": 158,
                        "match": {
                            "location": "pod_security_policy.go:873"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 158,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 914600
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-assigned-capabilities.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with assigned capabilities.",
                "description": "",
                "line": 159,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-009",
                        "line": 146
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 159,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with assigned capabilities from being deployed to an existing Kubernetes cluster",
                        "line": 159,
                        "match": {
                            "location": "pod_security_policy.go:856"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 159,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "assigned capabilities \"ARE NOT\" requested for the Kubernetes deployment",
                        "line": 159,
                        "match": {
                            "location": "pod_security_policy.go:825"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1563508800
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 159,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires any capabilities",
                        "line": 159,
                        "match": {
                            "location": "pod_security_policy.go:873"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 443968800
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 159,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 387564800
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-assigned-capabilities.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with assigned capabilities.",
                "description": "",
                "line": 160,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-009",
                        "line": 146
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 160,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with assigned capabilities from being deployed to an existing Kubernetes cluster",
                        "line": 160,
                        "match": {
                            "location": "pod_security_policy.go:856"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 160,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "assigned capabilities \"Not defined\" requested for the Kubernetes deployment",
                        "line": 160,
                        "match": {
                            "location": "pod_security_policy.go:825"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2322854200
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 160,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires any capabilities",
                        "line": 160,
                        "match": {
                            "location": "pod_security_policy.go:873"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 410775700
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 160,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 442079200
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-volume-types;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved volume types",
                "description": "",
                "line": 172,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-010",
                        "line": 162
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 172,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved volume types from being deployed to an existing Kubernetes cluster",
                        "line": 172,
                        "match": {
                            "location": "pod_security_policy.go:1030"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 172,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "\"unapproved\" volume types are requested for the Kubernetes deployment",
                        "line": 172,
                        "match": {
                            "location": "pod_security_policy.go:974"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 132420500
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "all operations will \"Fail\" with an error \"Cannot access unapproved volume type\"",
                        "line": 172,
                        "match": {
                            "location": "pod_security_policy.go:84"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-volume-types;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved volume types",
                "description": "",
                "line": 173,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-010",
                        "line": 162
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 173,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved volume types from being deployed to an existing Kubernetes cluster",
                        "line": 173,
                        "match": {
                            "location": "pod_security_policy.go:1030"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 173,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "\"approved\" volume types are requested for the Kubernetes deployment",
                        "line": 173,
                        "match": {
                            "location": "pod_security_policy.go:974"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 66301646800
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "all operations will \"Succeed\" with an error \"\"",
                        "line": 173,
                        "match": {
                            "location": "pod_security_policy.go:84"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-without-approved-seccomp-profile;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running without approved seccomp profile",
                "description": "",
                "line": 187,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-011",
                        "line": 175
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 187,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments without approved seccomp profiles from being deployed to an existing Kubernetes cluster",
                        "line": 187,
                        "match": {
                            "location": "pod_security_policy.go:1098"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 187,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"unapproved\" seccomp profile is requested for the Kubernetes deployment",
                        "line": 187,
                        "match": {
                            "location": "pod_security_policy.go:1062"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 181881000
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Cannot request unapproved seccomp profile\"",
                        "line": 187,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a system call that is blocked by the seccomp profile",
                        "line": 187,
                        "match": {
                            "location": "pod_security_policy.go:1115"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1012500
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 187,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-without-approved-seccomp-profile;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running without approved seccomp profile",
                "description": "",
                "line": 188,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-011",
                        "line": 175
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 188,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments without approved seccomp profiles from being deployed to an existing Kubernetes cluster",
                        "line": 188,
                        "match": {
                            "location": "pod_security_policy.go:1098"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 188,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"approved\" seccomp profile is requested for the Kubernetes deployment",
                        "line": 188,
                        "match": {
                            "location": "pod_security_policy.go:1062"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 3440366600
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"no error\"",
                        "line": 188,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a system call that is blocked by the seccomp profile",
                        "line": 188,
                        "match": {
                            "location": "pod_security_policy.go:1115"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 487898200
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 188,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 382080900
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-without-approved-seccomp-profile;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running without approved seccomp profile",
                "description": "",
                "line": 189,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-011",
                        "line": 175
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 189,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments without approved seccomp profiles from being deployed to an existing Kubernetes cluster",
                        "line": 189,
                        "match": {
                            "location": "pod_security_policy.go:1098"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 189,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"undefined\" seccomp profile is requested for the Kubernetes deployment",
                        "line": 189,
                        "match": {
                            "location": "pod_security_policy.go:1062"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 119452100
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Approved seccomp profile required\"",
                        "line": 189,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a system call that is blocked by the seccomp profile",
                        "line": 189,
                        "match": {
                            "location": "pod_security_policy.go:1115"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 945600
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 189,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-pods-from-exposing-unapproved-host-ports;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent pods from exposing unapproved host ports",
                "description": "",
                "line": 201,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-012",
                        "line": 191
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 201,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved port range from being deployed to an existing Kubernetes cluster",
                        "line": 201,
                        "match": {
                            "location": "pod_security_policy.go:938"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 201,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"unapproved\" hostPort is requested for the Kubernetes deployment",
                        "line": 201,
                        "match": {
                            "location": "pod_security_policy.go:892"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 165952300
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Cannot access unapproved port range\"",
                        "line": 201,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-pods-from-exposing-unapproved-host-ports;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent pods from exposing unapproved host ports",
                "description": "",
                "line": 202,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-012",
                        "line": 191
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 202,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved port range from being deployed to an existing Kubernetes cluster",
                        "line": 202,
                        "match": {
                            "location": "pod_security_policy.go:938"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 202,
                        "match": {
                            "location": "pod_security_policy.go:53"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"not defined\" hostPort is requested for the Kubernetes deployment",
                        "line": 202,
                        "match": {
                            "location": "pod_security_policy.go:892"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2951093100
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 202,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1043900
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-executing-commands-with-the-net_raw-capability.",
                "keyword": "Scenario",
                "name": "Prevent deployments from executing commands with the NET_RAW capability.",
                "description": "    Assuming cluster is configured to prevent NET_RAW capabilities:\n    - A container with explicit drop NET_RAW is deployed\n    - A command that doesn't require NET_RAW (such as ls) should succeed\n    - A command that requires NET_RAW (such as ping www.google.com) should fail",
                "line": 205,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@k-psp",
                        "line": 1
                    },
                    {
                        "name": "@probes/kubernetes/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@k-psp-013",
                        "line": 204
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 212,
                        "match": {
                            "location": "pod_security_policy.go:42"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment with NET_RAW capability \"Dropped\" is applied to an existing Kubernetes cluster",
                        "line": 213,
                        "match": {
                            "location": "pod_security_policy.go:669"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1980810700
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 214,
                        "match": {
                            "location": "pod_security_policy.go:66"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 0
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 215,
                        "match": {
                            "location": "pod_security_policy.go:112"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 402408400
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires NET_RAW capability",
                        "line": 216,
                        "match": {
                            "location": "pod_security_policy.go:701"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 459430800
                        }
                    }
                ]
            }
        ]
    }
]
