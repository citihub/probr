apiVersion: v1
kind: Pod
metadata:
  name: #IAMTEST#
  labels:
    aadpodidbinding: #demo  #TODO: need to inject this
  annotations:
    seccomp.security.alpha.kubernetes.io/pod: "runtime/default"
spec:
  securityContext:
   runAsUser: 1000
   runAsGroup: 3000
   fsGroup: 2000
   supplementalGroups: [ 1 ]
  containers:
  - name: demo
    image: mcr.microsoft.com/k8s/aad-pod-identity/demo:1.2
    args:
      - --subscriptionid=0874697e-6631-4cb6-bb7f-d638269ce6d7
      - --clientid=44edb6a7-0f07-4bc1-9548-91cf901e9425
      - --resourcegroup=MC_rg-probr-all-policies_ProbrAllPolicies_uksouth
    env:
      - name: MY_POD_NAME
        valueFrom:
          fieldRef:
            fieldPath: metadata.name
      - name: MY_POD_NAMESPACE
        valueFrom:
          fieldRef:
            fieldPath: metadata.namespace
      - name: MY_POD_IP
        valueFrom:
          fieldRef:
            fieldPath: status.podIP
    securityContext:
      allowPrivilegeEscalation: false
  nodeSelector:
    kubernetes.io/os: linux